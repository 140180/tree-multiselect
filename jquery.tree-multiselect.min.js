/* jQuery Tree Multiselect v1.8.1 | (c) Patrick Tsai | MIT Licensed */
!function(a){function b(b){var c={sortable:!1,collapsible:!0,startCollapsed:!1,sectionDelimiter:"/"};return a.extend({},c,b)}function c(b,c){function e(b,c){for(var d=f,e=0;e<b.length;++e){var g=b[e];if(d[g]||(d[g]=[]),d=d[g],e==b.length-1){d.push(c);break}g=b[e+1];for(var h=null,i=0;i<d.length;++i){var j=d[i];if(j.constructor!=m&&a.isPlainObject(j)&&j[g]&&"undefined"!=typeof j[g]){h=j;break}}if(h)d=h;else{var k=d.push({});d=d[k-1]}}}var f={};a(b).find("> option").each(function(){var b=a(this).attr("data-section").split(k.sectionDelimiter),c=a(this).val(),d=a(this).text(),f=a(this).attr("data-description"),g=new m(c,d,f);e(b,g)}),d.call(c,f)}function d(b){function c(b){var c=document.createElement("div");c.className="section";var d=document.createElement("div");return d.className="title",d.innerHTML=b,a(c).append(d),a(this).append(c),c}function e(b,c,d){var e=document.createElement("div");e.className="item",a(e).text(c||b).attr("data-value",b).attr("data-description",d),a(this).append(e)}if(b.constructor==m)e.call(this,b.value,b.text,b.description);else if(a.isArray(b))for(var f=0;f<b.length;++f)d.call(this,b[f]);else if("object"==typeof b){for(var g in b)if(b.hasOwnProperty(g)){var h=c.call(this,g);d.call(h,b[g])}}else e.call(this,b)}function e(b){var c=a("<input />",{type:"checkbox"}),d=a(b).find("div.title, div.item");c.prependTo(d)}function f(b,c){var d=a(b).val();if(d)for(var e=0;e<d.length;++e){var f=d[e],g=a(c).find("div.item").filter(function(){var b=a(this);return b.attr("data-value")===f});a(g).find("> input[type=checkbox]").prop("checked",!0)}}function g(b){var c=a(b).find("div.title > input[type=checkbox]");c.change(function(){var b=a(this).closest("div.section"),c=b.find("input[type=checkbox]"),d=a(this).is(":checked");c.prop("checked",d)})}function h(b){var c=a(b).find("input[type=checkbox]");c.change(function(){if(!a(this).is(":checked")){var b=a(this).parents("div.section");b.find("> div.title > input[type=checkbox]").prop("checked",!1)}})}function i(b){var c="-",d="+",e=a(b).find("div.title"),f=document.createElement("div");f.className="collapse-section",k.startCollapsed?(a(f).text(d),e.siblings().toggle()):a(f).text(c),e.prepend(f),a("div.collapse-section").off().click(function(){var b=a(this).text();a(this).text(b==c?d:c);var e=a(this).parent();e.siblings().toggle()})}function j(b,c,d){function e(b){var d=document.createElement("div");d.className="item",d.innerHTML=b,a(c).append(d)}function f(b){var d=[];a(c).find("div.item").each(function(){d.push(a(this).text())});var f=b.filter(function(a){return-1==d.indexOf(a)});f.forEach(function(a){e(a)})}function g(b){a(c).find("div.item").each(function(){var c=a(this).text();-1==b.indexOf(c)&&a(this).remove()})}function h(){var b=a(d);b.empty(),a(c).find("div.item").text(function(c,d){var e=document.createElement("option");b.append(a(e).val(d).text(d).prop("selected",!0))})}function i(){var d=a(b).find("div.item").has("> input[type=checkbox]:checked"),e=[];if(d.text(function(a,b){e.push(b)}),f(e),g(e),h(),k.sortable){var i=a(c);i.sortable({update:function(a,b){h()}})}}var j=a(b).find("input[type=checkbox]");j.change(function(){i()}),i()}var k;a.fn.treeMultiselect=function(a){var d=this;k=b(a),this.attr("multiple","").css("display","none");var m=new l;m.build(d);var n=m.selections;c(d,n),e(n),f(d,n),g(n),h(n),k.collapsible&&i(n);var o=m.selected;return j(n,o,this),this};var l=function(){};l.prototype.build=function(b){var c=document.createElement("div");c.className="tree-multiselect",a(b).after(c);var d=document.createElement("div");d.className="selections",a(c).append(d);var e=document.createElement("div");e.className="selected",a(c).append(e),this.tree=c,this.selections=d,this.selected=e};var m=function(a,b,c){this.value=a,this.text=b,this.description=c}}(jQuery);